# coding:utf8
# python2

from x64dbgpy.pluginsdk import x64dbg

args_tuple = (
    (0x0, 0x13B274),
    (0x0, 0x160D384),
    (0x0, 0x16BDB88),
    (0x0, 0x1E16077),
    (0x0, 0x1F8CAE3),
    (0x0, 0x29985DE),
    (0x0, 0x2A85667),
    (0x0, 0x2AA3037),
    (0x0, 0x3087237),
    (0x0, 0x4166E5),
    (0x0, 0x44F8007),
    (0x0, 0x44F8011),
    (0x0, 0x4AA5B95),
    (0x0, 0x54BCA37),
    (0x0, 0x56FDE3),
    (0x0, 0x61F98A7),
    (0x0, 0x6AA0E84),
    (0x0, 0x6CE7D95),
    (0x0, 0x6F6E3C7),
    (0x0, 0x78F20F5),
    (0x0, 0x79EAE4),
    (0x0, 0x7A2BC0),
    (0x0, 0x7F96C13),
    (0x0, 0x803F0F3),
    (0x0, 0x883CECE),
    (0x0, 0x886D397),
    (0x0, 0x8ADF2D1),
    (0x0, 0xA0733D4),
    (0x0, 0xA39ECC7),
    (0x0, 0xAB8BA27),
    (0x0, 0xABB2B5),
    (0x0, 0xAD64007),
    (0x0, 0xAD68947),
    (0x0, 0xAE63487),
    (0x0, 0xB1C1FE3),
    (0x0, 0xB1FD105),
    (0x0, 0xB7AC9A5),
    (0x0, 0xB86DE55),
    (0x0, 0xB8E7DB5),
    (0x0, 0xBA94474),
    (0x0, 0xBC487A2),
    (0x0, 0xBF8BA27),
    (0x0, 0xC702BE2),
    (0x0, 0xC8C784),
    (0x0, 0xC96D047),
    (0x0, 0xCAB48C4),
    (0x0, 0xCACCDC4),
    (0x0, 0xCB9B43E),
    (0x0, 0xD641D17),
    (0x0, 0xD6756C7),
    (0x0, 0xD6C4B47),
    (0x0, 0xD6FB224),
    (0x0, 0xD733213),
    (0x0, 0xE48E148),
    (0x0, 0xEC06465),
    (0x0, 0xEE41457),
    (0x0, 0xFBF1D65),
    (0x0, 0xFDA8B77),
    (0x0, 0xFED02A7),
    (0x1, 0x66FA595),
    (0x1, 0x868A4C3),
    (0x1, 0x9C1F217),
    (0x1, 0xA255257),
    (0x1, 0xA7D67A7),
    (0x1, 0xBC2BFF7),
    (0x1, 0xCC4B6F7),
    (0x1, 0xD3997B7),
    (0x1, 0xF3C7B77),
    (0x13, 0x5B4D601),
    (0x13, 0x714B685),
    (0x13, 0x7E90205),
    (0x13, 0x85DC001),
    (0x13, 0xAE775E1),
    (0x13, 0xB157A91),
    (0x13, 0xBEB9491),
    (0x14, 0xC3B09DB),
    (0x14, 0xD926BDB),
    (0x3, 0x1555467),
    (0x3, 0x26C10F7),
    (0x3, 0x42C2F97),
    (0x3, 0x6F3BCC7),
    (0x3, 0x7F28F61),
    (0x3, 0x7F28F77),
    (0x3, 0x87BD287),
    (0x3, 0x8A42E41),
    (0x3, 0xD0682F7),
    (0x6, 0x2307572),
    (0x6, 0x6799C74),
    (0x6, 0x69044),
    (0x6, 0x78BA6),
    (0x6, 0x79C2BA4),
    (0x6, 0x79C44),
    (0x6, 0x7A5A1C4),
    (0x6, 0x86ED427),
    (0x6, 0x9805D4C),
    (0x6, 0xA5F9AC4),
    (0x6, 0xA654BC4),
    (0x6, 0xAD54EBF),
    (0x6, 0xC605FBF),
    (0x6, 0xCE53547),
    (0x6, 0xD0FB754),
    (0x6, 0xD707572),
    (0x6, 0xFCAB14E),
    (0x8, 0x3A5687),
    (0x9, 0x23ED221),
    (0x9, 0x3111C69),
    (0x9, 0x340868D),
    (0x9, 0x4A8239C),
    (0x9, 0x4A9139C),
    (0x9, 0x8097C7),
    (0x9, 0x89DE501),
    (0x9, 0x8A8238C),
    (0x9, 0x90EC817),
    (0x9, 0xA2414E7),
    (0x9, 0xABC78F7),
    (0x9, 0xBD557E),
    (0x9, 0xBE1EF6E),
    (0x9, 0xC38858),
    (0x9, 0xCEE5EA4),
    (0x9, 0xDA29A27),
    (0x9, 0xDD270B7),
    (0x9, 0xF2B7EBE),
    (0xC, 0x2360798),
    (0xC, 0xC3334A5),
    (0xD, 0x4DA8F17),
    (0xD, 0xA8B0327),
    (0xD, 0xDC7CC33),
)


x64dbg.SetBreakpoint(0x03091D88)  # push参数的位置
x64dbg.Run()
x64dbg.DeleteBreakpoint(0x03091D88)

for args in args_tuple:
    args_str = "(" + hex(args[0])
    for arg in args[1:]:
        args_str += ", " + hex(arg)
    args_str += ")"
    for arg in args[::-1]:
        x64dbg.Push(arg)
    x64dbg.SetEIP(0x03091D8B)  # 调用获取api函数的位置
    x64dbg.StepOver()

    # log "<args_str>: \"{modname@eax}.{label@eax}\""
    x64dbg.DbgScriptCmdExec('log "' + args_str + '":\ ' + '\\"{modname@eax}.{label@eax}\\"\,')

    x64dbg.SetEIP(0x03091D88)  # push参数的位置

"""
(0x0, 0x13b274): "kernel32.dll.GetCurrentProcessId",
(0x0, 0x160d384): "kernel32.dll.GetCurrentThread",
(0x0, 0x16bdb88): "kernel32.dll.GetFileSizeEx",
(0x0, 0x1e16077): "kernel32.dll.CreateProcessW",
(0x0, 0x1f8cae3): "kernel32.dll.VirtualAlloc",
(0x0, 0x29985de): "ntdll.dll.RtlLeaveCriticalSection",
(0x0, 0x2a85667): "kernel32.dll.FindNextFileW",
(0x0, 0x2aa3037): "kernel32.dll.GetTempPathW",
(0x0, 0x3087237): "kernel32.dll.CreateDirectoryW",
(0x0, 0x4166e5): "kernel32.dll.GetFileTime",
(0x0, 0x44f8007): "kernel32.dll.GetVersionExW",
(0x0, 0x44f8011): "kernel32.dll.GetVersionExA",
(0x0, 0x4aa5b95): "kernel32.dll.FindClose",
(0x0, 0x54bca37): "kernel32.dll.OpenMutexW",
(0x0, 0x56fde3): "kernel32.dll.FlushFileBuffers",
(0x0, 0x61f98a7): "kernel32.dll.ExpandEnvironmentStringsW",
(0x0, 0x6aa0e84): "kernel32.dll.CreateToolhelp32Snapshot",
(0x0, 0x6ce7d95): "kernel32.dll.WideCharToMultiByte",
(0x0, 0x6f6e3c7): "kernel32.dll.GetComputerNameW",
(0x0, 0x78f20f5): "kernel32.dll.GetSystemTime",
(0x0, 0x79eae4): "kernel32.dll.WaitForSingleObject",
(0x0, 0x7a2bc0): "kernel32.dll.Sleep",
(0x0, 0x7f96c13): "kernel32.dll.ExitProcess",
(0x0, 0x803f0f3): "kernel32.dll.OpenProcess",
(0x0, 0x883cece): "kernel32.dll.GetTimeZoneInformation",
(0x0, 0x886d397): "kernel32.dll.GetTempFileNameW",
(0x0, 0x8adf2d1): "kernel32.dll.LoadLibraryA",
(0x0, 0xa0733d4): "kernel32.dll.CreateThread",
(0x0, 0xa39ecc7): "kernel32.dll.GetModuleHandleW",
(0x0, 0xab8ba27): "kernel32.dll.SetFileAttributesW",
(0x0, 0xabb2b5): "kernel32.dll.WriteFile",
(0x0, 0xad64007): "kernel32.dll.DeleteFileW",
(0x0, 0xad68947): "kernel32.dll.CreateFileW",
(0x0, 0xae63487): "kernel32.dll.FindFirstFileW",
(0x0, 0xb1c1fe3): "kernel32.dll.GetProcAddress",
(0x0, 0xb1fd105): "kernel32.dll.VirtualFree",
(0x0, 0xb7ac9a5): "kernel32.dll.ReadFile",
(0x0, 0xb86de55): "kernel32.dll.HeapFree",
(0x0, 0xb8e7db5): "kernel32.dll.CloseHandle",
(0x0, 0xba94474): "ntdll.dll.RtlExitUserThread",
(0x0, 0xbc487a2): "kernel32.dll.MultiByteToWideChar",
(0x0, 0xbf8ba27): "kernel32.dll.GetFileAttributesW",
(0x0, 0xc702be2): "kernel32.dll.GetLastError",
(0x0, 0xc8c784): "kernel32.dll.Thread32Next",
(0x0, 0xc96d047): "kernel32.dll.MoveFileExW",
(0x0, 0xcab48c4): "kernel32.dll.ResetEvent",
(0x0, 0xcaccdc4): "kernel32.dll.SetEvent",
(0x0, 0xcb9b43e): "ntdll.dll.RtlEnterCriticalSection",
(0x0, 0xd641d17): "kernel32.dll.CreateEventW",
(0x0, 0xd6756c7): "kernel32.dll.RemoveDirectoryW",
(0x0, 0xd6c4b47): "kernel32.dll.Process32FirstW",
(0x0, 0xd6fb224): "kernel32.dll.GetOverlappedResult",
(0x0, 0xd733213): "kernel32.dll.IsWow64Process",
(0x0, 0xe48e148): "kernel32.dll.ReleaseMutex",
(0x0, 0xec06465): "kernel32.dll.SetEndOfFile",
(0x0, 0xee41457): "kernel32.dll.CreateMutexW",
(0x0, 0xfbf1d65): "kernel32.dll.GetLocalTime",
(0x0, 0xfda8b77): "kernel32.dll.GetModuleFileNameW",
(0x0, 0xfed02a7): "kernel32.dll.Process32NextW",
(0x1, 0x66fa595): "user32.dll.TranslateMessage",
(0x1, 0x868a4c3): "user32.dll.MsgWaitForMultipleObjects",
(0x1, 0x9c1f217): "user32.dll.CharUpperW",
(0x1, 0xa255257): "user32.dll.DispatchMessageW",
(0x1, 0xa7d67a7): "user32.dll.SetWindowLongW",
(0x1, 0xbc2bff7): "user32.dll.PeekMessageW",
(0x1, 0xcc4b6f7): "user32.dll.GetMessageW",
(0x1, 0xd3997b7): "ntdll.dll.NtdllDefWindowProc_W",
(0x1, 0xf3c7b77): "user32.dll.CreateWindowExW",
(0x13, 0x5b4d601): "wininet.dll.InternetSetOptionA",
(0x13, 0x714b685): "wininet.dll.InternetCloseHandle",
(0x13, 0x7e90205): "wininet.dll.InternetReadFile",
(0x13, 0x85dc001): "wininet.dll.InternetQueryOptionA",
(0x13, 0xae775e1): "wininet.dll.InternetConnectA",
(0x13, 0xb157a91): "wininet.dll.HttpSendRequestA",
(0x13, 0xbeb9491): "wininet.dll.HttpOpenRequestA",
(0x14, 0xc3b09db): "userenv.dll.DestroyEnvironmentBlock",
(0x14, 0xd926bdb): "userenv.dll.CreateEnvironmentBlock",
(0x3, 0x1555467): "shlwapi.dll.PathMatchSpecW",
(0x3, 0x26c10f7): "shlwapi.dll.SHDeleteValueW",
(0x3, 0x42c2f97): "shlwapi.dll.PathRemoveFileSpecW",
(0x3, 0x6f3bcc7): "shlwapi.dll.PathSkipRootW",
(0x3, 0x7f28f61): "shlwapi.dll.wvnsprintfA",
(0x3, 0x7f28f77): "shlwapi.dll.wvnsprintfW",
(0x3, 0x87bd287): "shlwapi.dll.PathIsRelativeW",
(0x3, 0x8a42e41): "shlwapi.dll.StrCmpNIA",
(0x3, 0xd0682f7): "shlwapi.dll.PathRemoveBackslashW",
(0x6, 0x2307572): "ws2_32.dll.WSASetLastError",
(0x6, 0x6799c74): "ws2_32.dll.accept",
(0x6, 0x69044): "ws2_32.dll.bind",
(0x6, 0x78ba6): "ws2_32.dll.recv",
(0x6, 0x79c2ba4): "ws2_32.dll.select",
(0x6, 0x79c44): "ws2_32.dll.send",
(0x6, 0x7a5a1c4): "ws2_32.dll.socket",
(0x6, 0x86ed427): "ws2_32.dll.WSAStringToAddressW",
(0x6, 0x9805d4c): "ws2_32.dll.WSAIoctl",
(0x6, 0xa5f9ac4): "ws2_32.dll.setsockopt",
(0x6, 0xa654bc4): "ws2_32.dll.connect",
(0x6, 0xad54ebf): "ws2_32.dll.getaddrinfo",
(0x6, 0xc605fbf): "ws2_32.dll.freeaddrinfo",
(0x6, 0xce53547): "ws2_32.dll.WSAAddressToStringW",
(0x6, 0xd0fb754): "ws2_32.dll.closesocket",
(0x6, 0xd707572): "ws2_32.dll.WSAGetLastError",
(0x6, 0xfcab14e): "ws2_32.dll.shutdown",
(0x8, 0x3a5687): "shell32.dll.SHGetFolderPathW",
(0x9, 0x23ed221): "advapi32.dll.CryptHashData",
(0x9, 0x3111c69): "advapi32.dll.RegCloseKey",
(0x9, 0x340868d): "advapi32.dll.CryptGetHashParam",
(0x9, 0x4a8239c): "advapi32.dll.SetSecurityDescriptorSacl",
(0x9, 0x4a9139c): "advapi32.dll.SetSecurityDescriptorDacl",
(0x9, 0x8097c7): "advapi32.dll.RegQueryValueExW",
(0x9, 0x89de501): "advapi32.dll.CryptAcquireContextA",
(0x9, 0x8a8238c): "advapi32.dll.GetSecurityDescriptorSacl",
(0x9, 0x90ec817): "advapi32.dll.SetNamedSecurityInfoW",
(0x9, 0xa2414e7): "advapi32.dll.LookupPrivilegeValueW",
(0x9, 0xabc78f7): "advapi32.dll.ConvertStringSecurityDescriptorToSecurityDescriptorW",
(0x9, 0xbd557e): "advapi32.dll.GetTokenInformation",
(0x9, 0xbe1ef6e): "advapi32.dll.OpenThreadToken",
(0x9, 0xc38858): "advapi32.dll.CryptDestroyHash",
(0x9, 0xcee5ea4): "advapi32.dll.CryptReleaseContext",
(0x9, 0xda29a27): "advapi32.dll.RegOpenKeyExW",
(0x9, 0xdd270b7): "advapi32.dll.RegSetValueExW",
(0x9, 0xf2b7ebe): "advapi32.dll.OpenProcessToken",
(0xc, 0x2360798): "ole32.dll.CoInitializeEx",
(0xc, 0xc3334a5): "ole32.dll.CoUninitialize",
(0xd, 0x4da8f17): "psapi.dll.GetModuleBaseNameW",
(0xd, 0xa8b0327): "psapi.dll.GetModuleFileNameExW",
(0xd, 0xdc7cc33): "psapi.dll.EnumProcessModules",
"""
